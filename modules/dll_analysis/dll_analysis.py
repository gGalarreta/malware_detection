import pefile

class Dll():

  def __init__(self):
    self.name = ""

  def disassemble(self, pe_data, file_name):
    file = open(file_name,"w")
    self.disassemble_imported_symbols(pe_data, file)
    self.disassemble_exported_symbols(pe_data, file)

  def disassemble_imported_symbols(self, pe_data, file):
    if pe_data.OPTIONAL_HEADER.DATA_DIRECTORY[pefile.DIRECTORY_ENTRY['IMAGE_DIRECTORY_ENTRY_IMPORT']].VirtualAddress != 0:
      pe_data.parse_data_directories(directories=[pefile.DIRECTORY_ENTRY['IMAGE_DIRECTORY_ENTRY_IMPORT']])
      for entry in pe_data.DIRECTORY_ENTRY_IMPORT:
        for imp in entry.imports:
          file.write(imp.name)
          file.write("\n")

  def disassemble_exported_symbols(self, pe_data, file):
    # d = [pefile.DIRECTORY_ENTRY["IMAGE_DIRECTORY_ENTRY_EXPORT"]]
    # pe_data.parse_data_directories(directories=d)
    # exports = [(e.ordinal, e.name) for e in pe_data.DIRECTORY_ENTRY_EXPORT.symbols]
    # for export in sorted(exports):
      # print "imp_ordinal_%-4d imp_%s" % export
    return True
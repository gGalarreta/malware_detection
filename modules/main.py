#!/usr/bin/env  python

from binary_analysis import binary_analysis
from raw_analysis import raw_analysis
from dll_analysis import dll_analysis
from opcode_analysis import opcode_analysis
from k_means import k_means
#from neural_network import neural_network
from sklearn.feature_extraction.text import TfidfVectorizer
#from svm import svm
import pefile
import pydasm
import sys

if __name__ == '__main__':

  b = binary_analysis.BinaryAnalysis()
  b.dll = True
  b.opcodes = True
  #b.get_top_features_through_rules()
  #b.vectorize()



  # -------------------- Funcionality Test ---------------

  #b = binary_analysis.BinaryAnalysis()
  #b.get_train_test_data(90)
  #b.get_rules()
  #b.set_malware_directory("//home/gustavo/Projects/malware_data/data_set")
  #b.disassemble("dll", "opcode")
  #b.opcodes = True
  #b.dll = True
  #b.extract_features()
  #b.feature_vector()
  #b.vectorize_samples()


  #svm_m = svm.Svm()
  #svm_m.svm_model("/home/gustavo/Projects/malware-detection/modules/features/matrix_features.txt", "/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/index.txt")


  #cnn = neural_network.ConvNet()
  #cnn.set_batch_size(40)
  #cnn.set_epochs(4)
  #cnn.set_hidden_size(50)
  #cnn.network_model("/home/gustavo/Projects/malware-detection/modules/features/matrix_features.txt", "/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/index.txt")
  


  #x,y = cnn.set_data("/home/gustavo/Projects/malware-detection/modules/features/matrix_features.txt", "/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/index.txt")
  #cnn.train("/home/gustavo/Projects/malware-detection/modules/features/matrix_features.txt", "/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/index.txt")
  #cnn.set_settings("/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/index.txt")
  #print cnn.classes
  
  #o = opcode_analysis.Opcode()
  #v = b.read_file(b.opcode_feature_vector_name)
  #v_attr = b.read_file("/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/Adware/opcode/VirusShare_1ebf190cb60689b186fb0eb9585374b9.txt")
  #print o.ngrams(v_attr)
  #b_v = b.get_binary_vector(o.ngrams(v_attr), v)
  #print b_v

  #r = raw_analysis.Raw()
  #r.set_labels()
  #print r.file_header_labels

  #k = k_means.Kmeans()
  #k.set_number_top_words(20)
  #k.set_cluster_range(2,5)
  #o = opcode_analysis.Opcode()
  #o.extract_features(k, "/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/class3/opcode", "/home/gustavo/Projects/malware-detection/modules/test_opcode.txt")

  #d = dll_analysis.Dll()
  #d.extract_features(k, "/home/gustavo/Projects/malware-detection/modules/raw_final_dataset/class1/dll", "/home/gustavo/Projects/malware-detection/modules/test_dll.txt")
  #b = binary_analysis.BinaryAnalysis()
  #b.dll = True
  #b.opcodes = True
  #b.vectorize()